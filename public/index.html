<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🍾 Message in a Bottle</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="title">🌊 Message in a Bottle</h1>
            <p class="subtitle">Cast your thoughts into the digital ocean and discover messages from strangers</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        
        <!-- Action Buttons -->
        <div class="action-bar">
            <button id="show-form-btn" class="btn btn-primary">
                ✍️ Write a Message
            </button>
            <button id="fish-btn" class="btn btn-secondary">
                🎣 Fish for a Bottle
            </button>
            <div id="bottle-counter" class="bottle-counter">
                0 bottles floating
            </div>
        </div>

        <!-- Ocean Section (Default View) -->
        <section id="ocean-section" class="ocean-section">
            <div class="ocean-container">
                <div id="ocean" class="ocean">
                    <!-- Bottles will be dynamically added here -->
                </div>
                <div class="waves">
                    <div class="wave wave1"></div>
                    <div class="wave wave2"></div>
                    <div class="wave wave3"></div>
                </div>
            </div>
        </section>

        <!-- Message Form Section (Hidden by default) -->
        <section id="message-form-section" class="form-section" style="display: none;">
            <div class="form-container">
                <button id="hide-form-btn" class="btn-back">← Back to Ocean</button>
                
                <h2>✍️ Write Your Message</h2>
                <p class="form-description">Share your thoughts, hopes, or stories with the world</p>
                
                <form id="bottle-form" class="message-form">
                    <div class="form-group">
                        <label for="message-input">Your Message</label>
                        <textarea 
                            id="message-input" 
                            name="message"
                            placeholder="Write your message here... Share something meaningful, funny, or inspiring!"
                            maxlength="500"
                            rows="6"
                            required
                        ></textarea>
                        <div class="char-counter-container">
                            <span id="char-counter" class="char-counter">0/500</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="author-input">Your Name (Optional)</label>
                        <input 
                            id="author-input" 
                            type="text" 
                            name="author"
                            placeholder="Anonymous"
                            maxlength="50"
                        />
                    </div>
                    
                    <div id="form-error" class="form-error" style="display: none;"></div>
                    
                    <button id="throw-btn" type="submit" class="btn btn-primary btn-large">
                        🍾 Throw Bottle into Ocean
                    </button>
                </form>
            </div>
        </section>

    </main>

    <!-- Message Reader Modal -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;"></div>
    <div id="message-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <!-- Content will be dynamically populated -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>🌊 Made with love for connecting strangers across the digital ocean</p>
        <p class="footer-note">Messages are anonymous and public. Be kind! ❤️</p>
    </footer>

    <!-- Scripts - Load Firebase and App with correct path -->
    <script type="module">
        // Dynamically load the correct path based on environment
        const scriptPath = window.location.hostname.includes('localhost') || window.location.protocol === 'file:' 
            ? '../src/app.js' 
            : '/src/app.js';
        
        import(scriptPath)
            .catch(err => {
                console.error('Failed to load app.js, trying alternate path...', err);
                // Try alternate path
                return import('../src/app.js');
            })
            .catch(err => {
                console.error('Failed to load app:', err);
                alert('Failed to load application. Please check console.');
            });
    </script>
</body>
</html>